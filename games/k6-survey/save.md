# K6-Survey 数据保存机制

## 游戏概述
K6心理困扰量表调查 - 评估被试在过去30天内的心理健康状况和心理困扰程度的标准化问卷。

## 数据保存方式

### 保存触发条件
- 用户完成所有必填问题并点击"完成"按钮时自动保存

### 保存机制
1. **服务器保存**（主要方式）：
   - POST请求到 `/save` 端点
   - 成功后跳转到 `/next` 页面

2. **本地下载**（备用方式）：
   - 当服务器端点不可用时自动启用
   - 生成JSON文件：`k6-survey_result.json`
   - 按钮文本变更为"下载"，用户点击后保存到本地

## 数据结构

每个问题的回答记录以下数据：

| 字段 | 类型 | 描述 |
|------|------|------|
| `name` | String | 问题字段名（如"k6-survey_3_options"） |
| `value` | String/Number | 用户选择的值 |
| `options` | String | 该问题的所有可选项 |
| `text` | String | 问题文本内容 |

## 问卷内容结构

### 核心K6量表问题（6题）
1. 紧张 - 频率评估（1-5分）
2. 绝望 - 频率评估（1-5分）  
3. 不安或坐立不安 - 频率评估（1-5分）
4. 抑郁得什么都无法让您振作起来 - 频率评估（1-5分）
5. 觉得做任何事情都很费劲 - 频率评估（1-5分）
6. 觉得自己毫无价值 - 频率评估（1-5分）
7. 综合频率比较问题（1-7分）

### 功能影响评估问题（4题）
- 完全无法工作或活动的天数
- 只能做到正常一半的天数
- 就医次数
- 身体健康问题作为主要原因的频率

### 诊断历史问题（4题）
- 心理疾病诊断史（多选）
- 其他心理疾病描述
- 神经系统疾病诊断史
- 神经系统疾病描述

## 数据输出格式

```json
[
  {
    "name": "k6-survey_3_options",
    "value": "3",
    "options": "All of the time| Most of the time| Some of the time| A little of the time| None of the time",
    "text": "nervous?"
  },
  {
    "name": "k6-survey_4_options", 
    "value": "2",
    "options": "All of the time| Most of the time| Some of the time| A little of the time| None of the time",
    "text": "hopeless?"
  }
  // ... 更多问题回答
]
```

## 评分说明
- K6核心量表：6个问题分数相加，总分0-30分
- 高分表示更严重的心理困扰
- 功能影响问题提供补充评估信息
- 诊断历史用于背景信息收集

## 文件位置
- 主要逻辑：`index.html`（第427-490行）
- 问卷结构：`survey.tsv`
- 样式文件：`css/` 目录

## 使用说明
问卷会自动处理数据保存，用户完成所有必填题后点击完成按钮即可。如果在本地环境运行，数据将自动下载为JSON文件供后续分析使用。