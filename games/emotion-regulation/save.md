# 情绪调节任务 - 数据保存机制

## 概述
情绪调节任务是一个基于jsPsych框架的心理学实验，用于研究个体使用不同策略调节负面情绪的能力。该实验通过呈现情绪诱发图片（主要来自国际情感图片系统IAPS），要求参与者学习和使用两种主要的情绪调节策略：分心（distraction）和重新评价（reappraisal），为情绪调节的认知神经机制研究提供实验数据。

## 数据保存机制

### 保存位置和方式
- **主要方式**: AJAX POST请求到服务器端点 `/save`
- **备用方式**: 当服务器不可用时，自动下载CSV文件到本地
- **文件格式**: JSON格式（服务器）或CSV格式（本地）
- **文件名**: `emotion-regulation_results.csv`

### 数据保存流程
1. 实验使用jsPsych框架管理整个实验流程和数据收集
2. 每个试次完成后自动记录试次数据到jsPsych数据存储
3. 实验结束时序列化所有数据为JSON格式
4. 优先通过AJAX POST发送到服务器
5. 服务器不可用时触发本地CSV文件下载

### jsPsych数据结构
```javascript
{
  "rt": 1234,                           // 反应时间(毫秒)
  "stimulus": "<div class='imageBox'>...", // 刺激呈现HTML
  "key_press": 37,                      // 按键响应代码(37=左箭头, 39=右箭头)
  "trial_type": "poldrack-single-stim", // 试次类型
  "trial_index": 15,                    // 试次索引
  "time_elapsed": 45230,                // 实验开始以来的总时间
  "internal_node_id": "0.0.1.2",       // jsPsych内部节点ID
  "subject": "emotion-regulation-001",   // 被试标识符
  "trial_id": "stim-view",              // 自定义试次标识
  "exp_stage": "test",                  // 实验阶段(training/practice/test)
  "stim_intensity": "high",             // 图片情绪强度(high/low)
  "instruction_type": "choice",         // 指导类型(choice/distract/reappraise)
  "chosen_strategy": "distract",        // 选择的情绪调节策略
  "image_file": "3000.JPG"              // 呈现的图片文件名
}
```

### 实验结构与阶段
实验包含四个主要阶段：

1. **指导阶段** (Instruction):
   - 介绍实验目的和情绪调节策略
   - 解释分心和重新评价两种策略的定义和使用方法
   - 确保参与者充分理解任务要求

2. **训练阶段** (Training):
   - **试次数**: 4个训练试次
   - **目的**: 学习使用分心和重新评价策略
   - **结构**: 指定策略类型，观看图片15秒
   - **图片强度**: 高强度和低强度各2次

3. **练习阶段** (Practice):
   - **试次数**: 8个练习试次
   - **目的**: 熟悉策略选择和实施过程
   - **结构**: 混合指定策略和自主选择
   - **观看时间**: 5秒

4. **正式测试阶段** (Test):
   - **试次数**: 30个测试试次
   - **流程**: 预览图片(500ms) → 选择策略 → 观看并调节情绪(5秒)
   - **自主选择**: 所有试次都由参与者自主选择调节策略

### 情绪刺激材料
**图片来源**: 国际情感图片系统(IAPS, International Affective Picture System)

**低强度负性图片** (21张):
- 文件: 1270.JPG, 1301.JPG, 2278.JPG, 2312.JPG, 2490.JPG等
- 特点: 轻度负性情绪，用于基础情绪调节训练

**高强度负性图片** (21张):
- 文件: 2053.JPG, 2800.JPG, 3000.JPG, 3010.JPG, 3015.JPG等  
- 特点: 强烈负性情绪，测试情绪调节策略的有效性

### 情绪调节策略定义

1. **分心策略 (Distraction)**:
   - 定义: 在观看负性图片时想一些情绪上中性的事情
   - 机制: 注意力转移，减少对负性刺激的认知资源分配
   - 例子: 想象平静的风景、回忆中性事件、进行数学计算等

2. **重新评价策略 (Reappraisal)**:  
   - 定义: 以减少负面意义的方式重新解释图片内容
   - 机制: 认知重构，改变对刺激的情绪意义理解
   - 例子: 将伤心场景解释为电影拍摄、将危险情境视为安全演练等

### 数据保存实现代码
**初始化和数据收集** (`index.html:31-38`):
```javascript
jsPsych.init({
    timeline: emotion_regulation_experiment,
    on_trial_finish: function(data){
        addID('emotion-regulation')  // 添加实验标识符
    }
})
```

**实验结束数据保存** (`index.html:40-70`):
```javascript
on_finish: function(data){
    var data = jsPsych.data.dataAsJSON();
    $.ajax({
        type: "POST",
        url: '/save',
        data: { "data": data },
        success: function(){ document.location = "/next" },
        error: function(err) {
            if (err.status == 200){
                document.location = "/next";
            }
            jsPsych.data.localSave('emotion-regulation_results.csv', 'csv');
        }
    });
}
```

### 关键测量指标

1. **策略选择模式**:
   - 分心vs重新评价的选择频率
   - 高强度vs低强度图片的策略偏好
   - 策略选择的一致性和变化模式

2. **反应时间数据**:
   - 策略选择的反应时间
   - 不同策略和强度条件下的反应时间差异
   - 学习效应和疲劳效应

3. **主观报告**:
   - 实验后问卷：对任务的理解和体验
   - 策略使用的主观难易程度
   - 对不同策略有效性的感知

### 数据分析维度

1. **策略效能评估**:
   - 不同策略对情绪调节效果的比较
   - 个体差异：哪些人更倾向使用某种策略
   - 刺激强度与策略有效性的交互作用

2. **学习与适应**:
   - 从训练到测试阶段的策略使用变化
   - 策略选择的时间趋势分析
   - 反应时间的学习曲线

3. **认知负荷**:
   - 不同策略的认知资源需求
   - 反应时间作为认知负荷的指标
   - 策略切换的成本分析

### 技术实现特点

1. **jsPsych框架优势**:
   - 标准化的心理学实验程序
   - 精确的时间控制和反应时间测量
   - 丰富的插件支持多种试次类型
   - 自动数据收集和管理

2. **图片预加载** (`experiment.js:131-136`):
   - 所有图片在实验开始前预加载
   - 确保刺激呈现的精确时间控制
   - 避免网络延迟影响实验流程

3. **随机化设计**:
   - 图片呈现顺序随机化
   - 训练阶段策略顺序平衡化
   - 练习阶段试次类型随机分布

### 心理学应用价值

1. **临床应用**:
   - 情绪障碍的评估和干预
   - 情绪调节训练程序的开发
   - 认知行为疗法的效果评估

2. **基础研究**:
   - 情绪调节的神经机制研究  
   - 个体差异的认知基础
   - 发展心理学中情绪调节能力的变化

3. **应用心理学**:
   - 压力管理技能训练
   - 心理韧性的培养方案
   - 情绪智力的测量和提升

### 数据质量控制

1. **注意力检查**:
   - 可选的注意力检查试次 (`experiment.js:101, 190-202`)
   - 确保参与者专注于任务
   - 排除无效数据

2. **指导阅读时间控制**:
   - 最小阅读时间要求
   - 防止匆忙完成影响数据质量
   - 确保对任务的充分理解

3. **试次完整性**:
   - 所有关键试次的数据完整记录
   - 反应时间的合理性检查
   - 异常响应的识别和处理

### 研究伦理考虑

1. **情绪安全**:
   - 使用标准化的情绪刺激材料
   - 明确告知实验可能引发的情绪反应
   - 提供实验后的情绪缓冲和支持

2. **知情同意**:
   - 详细说明实验流程和可能风险
   - 强调参与的自愿性和退出权利
   - 保护参与者的情绪健康

3. **数据保护**:
   - 匿名化处理所有个人数据
   - 安全存储和限制访问权限
   - 遵守数据保护相关法规

### 扩展研究可能性

1. **生理测量整合**:
   - 结合EEG/fMRI进行神经机制研究
   - 整合心率、皮肤电导等自主神经指标
   - 眼动追踪分析注意力分配模式

2. **个体化训练**:
   - 基于个体策略偏好设计训练方案
   - 自适应难度调整机制
   - 实时反馈和强化学习

3. **跨文化研究**:
   - 不同文化背景下的情绪调节模式
   - 文化特异性策略的识别和验证
   - 跨文化情绪刺激材料的开发