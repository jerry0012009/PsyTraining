# 局部-整体字母实验 (Local-Global Letter) 数据保存机制

## 保存方式

### 主要保存方法
- **在线保存**: 实验结束时通过 AJAX POST 请求将数据发送到 `/save` 端点
- **本地备份**: 当在线保存失败时，自动触发本地保存

### 保存的文件
- **文件名**: `local-global-letter_results.csv`
- **格式**: CSV格式
- **位置**: 浏览器下载文件夹

## 数据内容

### 收集的数据类型
1. **实验配置数据**
   - 试验ID (trial_id)
   - 实验阶段 (exp_stage: 'practice' / 'test')
   - 条件 (condition: 'global' / 'local')
   - 整体形状 (global_shape: 's', 'h', 'o')
   - 局部形状 (local_shape: 's', 'h', 'o')

2. **被试反应数据**
   - 反应时间 (rt)
   - 按键反应 (key_press: 72='H', 83='S')
   - 正确答案 (correct_response)
   - 正确性 (correct: true/false)
   - 试验编号 (trial_num)

3. **实验控制变量**
   - 转换试验标记 (switch: 0/1, 表示是否从上一试验转换注意焦点)
   - 任务颜色分配 (随机分配蓝色和黑色对应全局或局部条件)

4. **性能评估数据**
   - 注意力检查数据
   - 后任务问卷回答
   - 总体表现评估 (credit_var)

### 实验设计
- **练习阶段**: 36个试验，包含反馈
- **正式测试**: 96个试验，无反馈
- **核心任务**: 根据字母颜色判断大字母(全局)还是小字母(局部)是"H"还是"S"
- **颜色-注意分配**: 
  - 一种颜色对应全局注意(判断大字母)
  - 另一种颜色对应局部注意(判断小字母)

## 数据流程

1. **数据收集**: jsPsych框架自动收集每个试验的反应时间、按键、正确性等数据
2. **性能评估**: 实验结束时计算总体表现指标，包括遗漏率、平均反应时间、反应分布等
3. **数据序列化**: 将收集的数据转换为JSON格式
4. **保存尝试**: 
   - 首先尝试POST到服务器 `/save` 端点
   - 成功则跳转到 `/next` 页面
   - 失败则触发本地CSV下载
5. **本地保存**: 使用 `jsPsych.data.localSave()` 方法保存为CSV文件

## 认知测量

### 测量的认知能力
- **选择性注意**: 根据颜色提示选择性地注意全局或局部特征
- **认知灵活性**: 在全局和局部注意之间的转换能力
- **抑制控制**: 抑制无关维度的干扰
- **处理速度**: 快速做出准确判断的能力

### 关键指标
- **转换成本**: 转换试验vs重复试验的反应时间差异
- **全局优势**: 全局vs局部处理的速度差异
- **错误率**: 不同条件下的准确性
- **反应时间变异性**: 反应一致性的测量

## 重要说明

- 该实验基于经典的Navon字母任务，测量全局-局部处理偏好
- 数据保存采用双重保障机制（在线+本地）
- 包含详细的性能评估算法，过滤无效数据
- 支持随机化的颜色-条件分配，减少偏差
- 实验包含中文界面和指导说明