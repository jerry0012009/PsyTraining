# Three-By-Two 任务数据保存说明

## 任务概述
Three-By-Two任务是一个任务转换（task-switching）认知控制实验，用于评估执行功能和认知灵活性。被试需要根据提示词在三个不同的认知任务间进行转换：颜色判断、奇偶性判断和大小判断，测量任务转换成本和认知控制能力。

## 数据保存机制

### 技术架构
- **实验框架**: jsPsych 实验心理学框架
- **核心插件**: poldrack-categorize（练习阶段）、poldrack-single-stim（测试阶段）
- **辅助插件**: call-function（刺激设置）、survey-text（问卷）
- **随机化**: jsPsych.randomization内置函数

### 任务设计

#### 三种认知任务
1. **颜色任务（Color Task）**
   - 提示词：'颜色' 或 '橙色-蓝色'
   - 判断数字的字体颜色（橙色/蓝色）
   - 橙色→第一个键，蓝色→第二个键

2. **奇偶性任务（Parity Task）**
   - 提示词：'奇偶性' 或 '奇数-偶数'
   - 判断数字的奇偶性
   - 偶数→第一个键，奇数→第二个键

3. **大小任务（Magnitude Task）**
   - 提示词：'大小' 或 '大-小'
   - 判断数字相对于5的大小
   - 大于5→第一个键，小于5→第二个键

#### 刺激特征
- **数字范围**: 1, 2, 3, 4, 6, 7, 8, 9（排除5避免大小任务歧义）
- **颜色设置**: 橙色(orange)、蓝色(blue)
- **随机分配**: 每个试验随机生成数字和颜色组合
- **反应键**: M键(77)和Z键(90)，随机对应两个选项

### 保存的数据字段

#### 刺激呈现数据
```javascript
// 注视点试验
{
    trial_id: "fixation",           // 注视点标识
    exp_stage: "practice|test",     // 实验阶段
    timing_stim: 500,               // 刺激持续时间
    timing_response: 500            // 反应时间窗口
}

// 提示呈现试验
{
    trial_id: "cue",                // 提示标识
    exp_stage: "practice|test",     // 实验阶段
    timing_response: 100|900,       // 提示-目标间隔(CTI)
    timing_stim: 100|900            // 提示显示时间
}
```

#### 主要反应数据
```javascript
{
    trial_id: "stim",                    // 刺激反应试验标识
    exp_stage: "practice|test",          // 实验阶段
    cue: "颜色|奇偶性|大小",             // 当前任务提示
    stim_color: "orange|blue",           // 刺激颜色
    stim_number: 1-9,                    // 刺激数字
    task: "color|parity|magnitude",      // 当前任务类型
    task_switch: "stay|switch_new|switch_old", // 任务转换类型
    cue_switch: "stay|switch",           // 提示转换类型
    trial_num: 0-439,                    // 试验编号
    key_press: 77|90,                    // 实际按键反应
    rt: 1234,                            // 反应时间（毫秒）
    correct: true|false,                 // 反应正确性
    correct_response: 77|90              // 正确反应键
}
```

### 任务转换设计

#### 转换类型系统
1. **Stay**: 保持当前任务，可能更换提示词
2. **Switch New**: 转换到非当前且非上一个的第三个任务
3. **Switch Old**: 转换回上一个任务

#### 提示-目标间隔(CTI)
```javascript
var setCTI = function() {
    return randomDraw([100, 900]);  // 100ms或900ms随机间隔
}
```

#### 转换概率控制
- 6种转换条件的组合：3种任务转换 × 2种提示转换
- 练习阶段：60个试验，每种条件10个试验
- 测试阶段：440个试验，每种条件约73个试验

### 实验流程控制

#### 练习阶段特点
- **试验数量**: 60个试验
- **反馈类型**: 正确/错误/超时的详细反馈
- **反馈显示**: 1000ms反馈持续时间
- **学习目标**: 建立任务规则和按键映射

#### 测试阶段特点
- **试验数量**: 440个试验
- **反馈类型**: 仅在线评分，无明显反馈显示
- **性能监控**: 实时计算正确性和反应时间
- **注意检查**: 阶段间插入注意力监控

### 数据质量控制

#### 性能评估函数（assessPerformance）
```javascript
var assessPerformance = function() {
    var missed_count = 0;              // 遗漏反应计数
    var trial_count = 0;               // 有效试验计数
    var rt_array = [];                 // 反应时间数组
    var choice_counts = {};            // 按键使用分布
    
    // 质量标准
    var missed_percent = missed_count/trial_count;  // 遗漏率
    var avg_rt = math.median(rt_array);             // 中位反应时间
    var responses_ok = true;                        // 反应分布检查
    
    // 通过标准：遗漏率<40%，反应时间>200ms，无单一按键过度使用
    credit_var = (missed_percent < 0.4 && avg_rt > 200 && responses_ok);
}
```

#### 数据筛选标准
- **遗漏率**: < 40%
- **最低反应时间**: > 200ms
- **按键分布**: 任一按键使用率 < 85%
- **反应窗口**: 最大2000ms反应时间

### 认知机制评估

#### 任务转换成本
1. **转换成本**: Switch试验 - Stay试验的反应时间差
2. **混合成本**: 混合块Stay试验 - 纯块试验的反应时间差
3. **准确率成本**: 转换条件下的准确率下降
4. **不对称转换成本**: 不同任务间转换难度差异

#### 认知控制指标
1. **任务设置更新**: 新任务规则的激活和配置
2. **任务设置重构**: 旧任务规则的抑制和新规则激活
3. **提示利用**: 提示信息对任务准备的促进作用
4. **干扰解决**: 不相关任务维度的抑制控制

### 执行功能评估

#### 核心执行功能
1. **抑制控制**: 抑制无关任务规则的能力
2. **工作记忆更新**: 维持和更新当前任务规则
3. **认知灵活性**: 在不同任务规则间灵活转换

#### 个体差异指标
- **基线反应时间**: 整体处理速度
- **转换成本大小**: 认知灵活性个体差异
- **准确率模式**: 速度-准确率权衡策略
- **学习效应**: 跨试验的表现改善

### 神经认知机制

#### 脑网络参与
1. **前额皮层**: 任务规则维持和转换控制
2. **前扣带皮层**: 冲突监控和认知控制
3. **顶叶皮层**: 注意定向和任务切换
4. **纹状体**: 认知控制的皮层-皮层下环路

#### 发展和老化
- **儿童发展**: 前额叶成熟与转换成本降低
- **老化效应**: 认知控制下降与转换成本增大
- **训练效果**: 任务转换训练的迁移效应
- **个体差异**: 执行功能能力的个体变异

### 数据分析指标

#### 基础性能指标
1. **平均反应时间**: 总体处理速度
2. **准确率**: 任务规则执行准确性
3. **反应时间变异性**: 反应一致性
4. **遗漏率**: 注意维持能力

#### 任务转换指标
1. **全局转换成本**: 混合vs纯块比较
2. **局部转换成本**: 转换vs重复试验比较
3. **任务不对称性**: 不同任务间的转换难度
4. **提示利用效应**: CTI对转换成本的调节

### 数据导出格式
jsPsych自动保存为JSON格式，包含：
- 每个试验的完整任务信息和反应数据
- 任务转换序列和提示信息
- 可计算各类转换成本和控制指标
- 支持个体差异分析和认知建模

## 临床应用价值
Three-By-Two任务广泛应用于：
- **执行功能评估**: ADHD和执行功能障碍的诊断辅助
- **认知灵活性测试**: 前额叶功能和认知控制能力评估
- **发展心理学**: 儿童执行功能发展轨迹研究
- **老化研究**: 老年人认知控制能力变化评估
- **神经心理评估**: 前额叶损伤和认知控制缺陷诊断

## 注意事项
- 确保被试理解三种任务规则及其对应的提示词
- 强调根据提示词切换任务而不是固定使用单一策略
- 注意CTI对任务准备时间的影响
- 监控转换成本的合理性和一致性