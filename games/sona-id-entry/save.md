# SONA ID Entry 数据保存机制

## 数据保存方式

这是一个学生ID信息收集表单，使用jQuery AJAX进行数据传输，具有双重保存策略：

### 1. 服务器保存 (首选)
- **端点**: `POST /save`
- **数据格式**: JSON Array
- **触发时机**: 表单提交时 (点击"完成"按钮)
- **成功后**: 自动跳转到 `/next`

### 2. 本地保存 (备用)
- **文件名**: `sona-id-entry_result.json`
- **格式**: JSON
- **触发条件**: 当服务器端点不可用或返回错误时
- **保存方法**: 自动下载到浏览器默认下载位置

## 保存的数据内容

### 数据结构
每个表单字段保存为一个对象，包含以下属性：

```json
{
  "name": "字段名称",
  "value": "用户输入值", 
  "options": "字段选项(如适用)",
  "text": "字段显示文本"
}
```

### 具体字段信息
1. **UTOR ID**
   - `name`: "sona-id-entry_2"
   - `text`: "请输入您的UTOR ID："
   - `value`: 用户输入的UTOR ID
   - 字段类型: 文本输入 (必填)

2. **学号**
   - `name`: "sona-id-entry_3"  
   - `text`: "请输入您的多伦多大学学号："
   - `value`: 用户输入的学号
   - 字段类型: 数字输入 (必填)
   - 验证规则: 整数或实数格式

## 数据处理流程

1. **表单验证**: 检查必填字段是否完整
2. **数据收集**: 遍历所有输入字段，提取值和元数据
3. **数据组装**: 将字段信息组织为JSON数组格式
4. **服务器提交**: AJAX POST到 `/save` 端点
5. **备用机制**: 失败时生成下载链接，保存为JSON文件

## 验证规则

- **必填验证**: UTOR ID和学号都是必填项
- **格式验证**: 学号必须符合数字格式 `(([0-9]+)(\.[0-9]+)?)|\.?[0-9]+`
- **错误提示**: 未填写必填项会标红提示，并弹出警告

## 功能特点

- **向导式界面**: 使用jQuery Wizard插件实现多步骤表单
- **进度条**: 显示完成进度
- **实时验证**: 前进到下一步时验证当前页面
- **响应式设计**: 使用Material Design样式

这个表单主要用于实验参与者身份识别，确保能够将同一参与者的多个实验数据关联起来。