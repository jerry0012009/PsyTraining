# BIS-11冲动性量表调查 - 数据保存机制

## 概述
BIS-11冲动性量表是一个心理学调查问卷，用于评估个体的冲动性行为倾向。该游戏通过31个问题评估用户在注意冲动、运动冲动和非计划冲动三个维度的表现。

## 数据保存机制

### 保存位置和方式
- **主要方式**: AJAX POST请求到服务器端点 `/save`
- **备用方式**: 当服务器不可用时，自动下载JSON文件到本地
- **文件名**: `bis11-survey_result.json`

### 数据保存流程
1. 用户完成所有31个问题并点击"完成"按钮
2. JavaScript收集所有已选择的答案数据
3. 首先尝试通过AJAX POST发送到 `/save` 端点
4. 如果服务器请求失败，自动触发本地下载机制

### 保存的数据结构
```javascript
[
  {
    "name": "bis11-survey_2_options",    // 问题标识
    "value": "3",                        // 用户选择的分值(1-4)
    "options": "很少/从不|偶尔|经常|几乎总是/总是", // 选项文本
    "text": "I plan tasks carefully."    // 英文问题描述
  },
  // ... 其他30个问题的数据
]
```

### 数据字段说明
- **name**: 问题的唯一标识符，格式为 `bis11-survey_[问题编号]_options`
- **value**: 用户选择的数值(1-4分)，其中：
  - 1 = 几乎总是/总是
  - 2 = 经常  
  - 3 = 偶尔
  - 4 = 很少/从不
- **options**: 选项的中文文本，用"|"分隔
- **text**: 问题的英文原始描述

### 评分机制
- 总共31个问题，每个问题1-4分
- 部分问题采用反向计分(如问题2、8、9等)
- 总分范围：31-124分
- 分数越高表示冲动性越强

### 代码实现位置
- **数据收集**: `index.html` 第629-650行的表单提交处理
- **AJAX保存**: 第653-688行的POST请求和错误处理
- **本地保存**: 第674-685行的文件下载机制

### 错误处理
- 当POST请求状态码为200时，重定向到 `/next`
- 其他错误情况下，将按钮文本改为"下载"，点击后下载JSON文件
- 包含中文提示："POST请求错误，下载到本地文件"

### 数据用途
保存的数据可用于：
- 计算BIS-11总分和各维度得分
- 评估个体冲动性水平
- 心理健康状况分析
- 认知行为模式研究

### 技术依赖
- jQuery库用于AJAX请求和DOM操作
- 现代浏览器支持的文件下载API
- 服务器端需要支持POST `/save` 和GET `/next` 端点