# Psychomotor Vigilance Test 任务数据保存说明

## 任务概述
Psychomotor Vigilance Test（PVT，心理运动警觉性测试）是评估持续注意力和警觉性的经典认知测试。被试需要在5分钟内监视蓝色方块，当方块变为红色时立即点击按钮，测量简单反应时间和警觉性维持能力。

## 数据保存机制

### 技术架构
- **实验框架**: 原生JavaScript，不依赖jsPsych
- **界面库**: jQuery 3.3.1 + Bootstrap样式
- **时间控制**: performance.now() 高精度时间测量
- **数据存储**: RESULTS对象存储所有试验数据

### 任务设计

#### 刺激设置
- **视觉刺激**: 蓝色正方形 → 红色正方形转换
- **反应方式**: 鼠标点击按钮
- **颜色变化**: 蓝色(默认) → 红色(信号) → 蓝色(恢复)
- **信号持续**: 红色显示500ms后自动恢复蓝色

#### 时间参数
- **练习阶段**: 30秒（生产环境）/ 10秒（开发环境）
- **正式测试**: 5分钟（生产环境）/ 20秒（开发环境）
- **变化间隔**: 2-10秒随机间隔
- **反应窗口**: 颜色变化后的完整时间

### 保存的数据字段

#### 数据结构
```javascript
RESULTS = {
    "0": { "clickedAfter": [] },           // 初始化记录
    "startTime1": { "clickedAfter": [diff1, diff2, ...] },  // 每次颜色变化的记录
    "startTime2": { "clickedAfter": [diff1, diff2, ...] },
    // ... 更多时间点记录
}
```

#### 时间点记录
- **Key**: 颜色变化的开始时间戳（毫秒，使用performance.now()）
- **clickedAfter**: 数组，记录该颜色变化后所有点击的反应时间差值

#### 反应时间计算
```javascript
// 颜色变为红色的时刻
startTime = Math.round(performance.now());

// 点击按钮时计算反应时间
const diff = Math.round(endTime - startTime);
RESULTS[`${startTime}`]["clickedAfter"].push(diff);
```

### 实验流程控制

#### 随机化机制
```javascript
let randomInterval = Math.floor(Math.random() * (max - min + 1) + min);
// max = 10秒（生产）/ 5秒（开发）
// min = 2秒（固定）
// 每次颜色变化后重新随机化下次间隔
```

#### 颜色变化逻辑
```javascript
const test = setInterval(() => {
    if (randomInterval == cue) {
        startTime = Math.round(performance.now());
        square.style.backgroundColor = "red";
        setTimeout(() => {
            square.style.backgroundColor = "blue"
        }, 500);  // 红色持续500ms
        randomInterval = Math.floor(Math.random() * (max - min + 1) + min);
        cue = 1;
    } else {
        square.style.backgroundColor = "blue";
        cue++
    }
}, 1000);  // 每秒检查一次
```

### 反应评估机制

#### 练习阶段反馈
- **快速反应** (≤800ms): 显示绿色"好！"
- **慢反应** (>800ms): 显示红色"太慢了"
- **反馈持续**: 500ms后消失

#### 正式测试反馈
- **有效反应** (≤1000ms): 显示具体反应时间 "XXX ms"
- **超慢反应** (>1000ms): 不显示任何反馈
- **反馈持续**: 500ms后消失

### 数据质量控制

#### 环境配置
```javascript
const IS_PRODUCTION = true;
const TIMEOUT = IS_PRODUCTION ? 1000 * 60 * 5 : 1000 * 20;  // 测试总时长
const PRACTICE_TIMEOUT = IS_PRODUCTION ? 30000 : 10000;      // 练习时长
const max = IS_PRODUCTION ? 10 : 5;                          // 最大间隔
```

#### 反应时间筛选
- **练习阶段**: 800ms为快/慢反应分界线
- **测试阶段**: 1000ms为有效反应上限
- **数据保存**: 所有点击都被记录，包括超时反应

### 警觉性测量指标

#### 基础反应时间指标
1. **平均反应时间**: 所有有效反应的均值
2. **中位反应时间**: 减少极值影响的稳健估计
3. **反应时间变异性**: 标准差或变异系数
4. **最快10%反应时间**: 最佳警觉状态指标

#### 警觉性衰退指标
1. **时间趋势分析**: 反应时间随时间增长的趋势
2. **慢反应比例**: 超过特定阈值的反应比例
3. **遗漏反应**: 未在合理时间内反应的刺激
4. **虚警反应**: 无信号时的错误点击

#### 疲劳与注意分散
1. **反应时间递增**: 持续任务中的警觉性下降
2. **注意缺失**: 长时间无反应或极慢反应
3. **不一致性增加**: 反应时间变异性增大
4. **策略性反应**: 预期性或机械性反应模式

### 数据传输机制

#### 数据保存函数
```javascript
async function sendResults(results) {
    if (IS_PRODUCTION) {
        $.ajax({
            type: "POST",
            url: '/save',
            data: results,
            success: function () { document.location = "/next" },
            error: function (err) {
                if (err.status == 200) {
                    document.location = "/next";
                } else {
                    console.log("results===>\n", results);
                }
            }
        });
    } else {
        console.log("===done===>", results);
    }
}
```

#### 服务器通信
- **成功上传**: 自动跳转到下一个实验
- **上传失败**: 本地控制台输出数据
- **开发模式**: 直接在控制台显示结果

### 认知功能评估

#### 持续注意力
1. **警觉性维持**: 5分钟持续监控的能力
2. **注意稳定性**: 反应时间一致性
3. **疲劳抵抗**: 长时间任务中的表现维持
4. **监视效率**: 信号检测的准确性和速度

#### 执行功能
1. **抑制控制**: 避免冲动性提前反应
2. **工作记忆**: 维持任务规则和目标
3. **认知灵活性**: 适应任务要求变化
4. **处理速度**: 基础认知处理效率

### 临床应用指标

#### 睡眠与疲劳评估
- **睡眠剥夺**: 反应时间延长和变异性增加
- **昼夜节律**: 不同时间点的警觉性差异
- **疲劳程度**: 持续注意力缺陷的客观测量
- **恢复效果**: 休息或治疗后的改善

#### 注意障碍评估
- **ADHD**: 持续注意力缺陷的核心症状
- **注意网络**: 警觉、定向和执行注意功能
- **认知控制**: 自上而下的注意调节
- **处理速度**: 信息处理效率评估

### 神经生理机制

#### 脑网络参与
1. **脑干觉醒系统**: 基础警觉状态维持
2. **额顶注意网络**: 自上而下的注意控制
3. **默认模式网络**: 注意分散和心智游离
4. **丘脑皮质系统**: 警觉性调节和维持

#### 神经递质系统
- **去甲肾上腺素**: 警觉性和注意觉醒
- **多巴胺**: 动机和奖励相关注意
- **乙酰胆碱**: 注意选择和认知控制
- **腺苷**: 睡眠压力和疲劳累积

### 数据导出格式
原生JavaScript以JSON对象格式存储，包含：
- 每次颜色变化的精确时间戳
- 该变化后所有点击反应的时间差
- 可计算各类警觉性和疲劳指标
- 支持时间序列分析和疲劳模式识别

## 临床应用价值
PVT任务广泛应用于：
- **睡眠医学**: 睡眠剥夺和睡眠障碍评估
- **疲劳研究**: 工作疲劳和认知疲劳测量
- **注意评估**: ADHD和注意缺陷障碍诊断
- **药物研究**: 精神药物对警觉性的影响
- **航空医学**: 飞行员疲劳和警觉性监控

## 注意事项
- 确保测试环境安静，避免外界干扰
- 强调持续专注监视，避免分心
- 注意区分有意延迟反应与真实警觉性下降
- 监控被试是否采用策略性预期反应